#include "COMMON.h"


char str[30]; //显示缓存
extern u8 _return;

extern uchar cfr2[4]; //cfr2控制字
extern uchar cfr1[4]; //cfr1控制字

uint16_t SweepMinFre = 100000000;
uint16_t SweepStepFre = 5;
uint16_t count1 = 1;
uint16_t i_max = 10000;
uint16_t i = 0;

int main()
{

	Init_ad9910();
	//Freq_convert(SweepMinFre + SweepStepFre*count1);

	print("AD9910 is ready\r\n");

	cfr1[0] = 0x00;		 //RAM 失能
	cfr2[1] = 0x00;		 //DRG 失能
	Txcfr();			 //发送cfrx控制字
	Amp_convert(400);	//写幅度，输入范围：1-650 mV
	Freq_convert(240000000); //写频率，输入范围：1-400 000 000Hz
	//SweepFre(160000000, 240000000, 80000 , 1000); //步进时间范围：4*(1~65536)ns


	while(1)
	{

		///PS_GPIO_SetPort(PROFILE1, 0);

		//	Amp_convert(600);				   //写幅度，输入范围：1-650 mV
												   //扫频波下限频率，上限频率，频率步进（单位：Hz），步进时间间隔（单位：us）
		//	SweepFre(16000000, 240000000, 80000 , 1000); //步进时间范围：4*(1~65536)ns

		//

		//Sawtooth_wave(2000000);

		//模拟外部triger triger接在OSK引脚上

		i++;

			if(i <= i_max/2)
			{
				PS_GPIO_SetPort(OSK, 1);
			}
			else if(i >= i_max/2 && i <= i_max)
			{
				PS_GPIO_SetPort(OSK, 0);
			}
			else
				i = 0;

		print("program is prossing\r\n");
	}
	return 0;
}
